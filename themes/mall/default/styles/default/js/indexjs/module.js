function $$(a){return document.getElementById(a)}function Mask(a){this.el=a;this.init()}Mask.prototype={init:function(){this.el.style.display="block";this.el.style.zIndex="999";var a=this.compute(this.el);this.set(a);this.addMask()},addMask:function(){this.mask=document.createElement("div");this.mask.className="alpha_div_alert";this.mask.innerHTML='<iframe height="100%" frameborder="0" width="100%" style="position: absolute; top: 0pt; left: 0pt; z-index: 1;"></iframe>';var a=this.mask.style;a.top="0px";a.left="0px";a.position="absolute";a.zIndex="998";a.width=this.getDocumentDimension("Width")-20+"px";a.height=this.getDocumentDimension("Height")+"px";a.backgroundColor="#FFF";document.body.insertBefore(this.mask,document.body.childNodes[0])},compute:function(e){var a={left:0,top:0};var d=this.getClientDimension("Height");var b=this.getClientDimension("Width");var c=document.documentElement.scrollTop;a.left=Math.ceil((b-this.el.offsetWidth)/2);a.top=c+Math.ceil((d-this.el.offsetHeight)/2);return a},getClientDimension:function(a){return document.documentElement["client"+a]||document.body["client"+a]},getDocumentDimension:function(a){return Math.max(document.documentElement["client"+a],document.body["client"+a])},set:function(a){this.el.style.position="absolute";this.el.style.top=a.top+"px";this.el.style.left=a.left+"px"},remove:function(){if(this.el){this.el.parentNode.removeChild(this.el);document.body.removeChild(this.mask);this.el=null}}};function call_alert(type,func,tips,title,text_1,text_2,text_3,btn_1,btn_2,width){var lei_1="block";var lei_2="block";if(type=="alert"){lei_2="none"}else{lei_1="none"}if(!title){title=""}if(!text_1){text_1="\u786e\u5b9a"}if(!text_2){text_2="\u786e\u5b9a"}if(!text_3){text_3="\u53d6\u6d88"}if(!width){width=350}width_1=width+12;$("body").append('<div class="pop_box_div" id="pop_box_div" style="width:'+width+'px;"><iframe frameborder="0" style="position:absolute;left:0;top:0;width:'+width_1+'px;height:500px;" id="pop_touming_iframe"></iframe><div class="pop_box_yinying" id="pop_touming_div" style="width:'+width_1+'px;height:500px;"></div><div  class="pop_box_body"  style="width:'+width+'px"><div class="pop_box_title"><span>'+title+'</span><a href="javascript:void(0);" class="pop_box_close"  id="pop_box_close1"></a></div><div class="pop_box_content">'+tips.replace(/<script/ig,"&lt;script")+'</div><div class="pop_box_button_1" style="display:'+lei_1+'"><a class="pop_button" href="#nogo" id="pop_box_close"><span>'+text_1+'</span></a></div><div class="pop_box_button_2"  style="display:'+lei_2+'"><a class="pop_button" href="#nogo" style=" margin-right:20px;" id="pop_box_true"><span>'+text_2+'</span></a><a class="pop_button" href="#nogo" id="pop_box_false"><span>'+text_3+'</span></a></div></div><a href="javascript:void(0)" id="a_focus" style="height:0;width:0;overflow:hidden;"></a></div>');var hh=new Mask($$("pop_box_div"));var pop_gao=$("#pop_box_div")[0].offsetHeight;$("#pop_touming_div")[0].style.height=pop_gao+"px";$("#pop_touming_iframe")[0].style.height=pop_gao+"px";$("#pop_box_div").animate({opacity:"1"},400);$$("pop_box_close1").onclick=function(){hh.remove()};$$("pop_box_close").onclick=function(){hh.remove();if(btn_1){if(typeof btn_1=="function"){btn_1()}else{eval(btn_1)}}};$$("a_focus").focus();$$("pop_box_true").onclick=function(){hh.remove();if(type!="alert"){if(typeof func=="function"){func()}else{eval(func)}}};$$("pop_box_false").onclick=function(){hh.remove();if(btn_2){if(typeof btn_2=="function"){btn_2()}else{eval(btn_2)}}};$$("pop_box_div").focus();if(type=="alert"){$$("pop_box_close").focus()}else{$$("pop_box_true").focus()}return hh}function TipDiv(b,a){this.html=b;this.options={width:"200px",iframe:true,className:"tipdiv",close:null,closeTag:"a",mask:true,zIndex:90,maskClassName:"alpha_div"};this.setOptions(a);this.init()}TipDiv.prototype={init:function(){var b=this;this.content=document.createElement("div");document.body.insertBefore(this.content,document.body.childNodes[0]);this.content.className=this.options.className;var d=this.content.style;d.position="absolute";d.zIndex=this.options.zIndex;d.display="none";d.width=this.options.width;var a=parseInt(this.options.width)-10+"px";var c=parseInt(this.options.height)-10+"px";this.content.innerHTML=this.html;if(this.options.mask){this.addMask()}if(this.options.close){this.addButton()}},setOptions:function(a){for(var b in (a||{})){this.options[b]=a[b]}return this},addMask:function(){this.mask=document.createElement("div");this.mask.className=this.options.maskClassName;if(this.options.iframe){this.mask.innerHTML='<iframe height="100%" frameborder="0" width="100%" style="position: absolute; top: 0pt; left: 0pt; z-index: 1;"></iframe>'}var a=this.mask.style;a.top="0px";a.left="0px";a.position="absolute";a.zIndex="80";a.backgroundColor="#000";a.width=this.getDocumentDimension("Width")+"px";a.height=this.getDocumentDimension("Height")+"px";document.body.insertBefore(this.mask,document.body.childNodes[0])},addButton:function(){var a=this;if(this.options.close){this.close=document.createElement("div");this.close.className=this.options.close;this.close.style.cursor="pointer";this.close.style.zIndex="99999";this.close.onclick=function(){a.hide()};this.content.appendChild(this.close)}},getDocumentDimension:function(a){return Math.max(document.documentElement["client"+a],document.body["client"+a])},show:function(a,b){if(this.content.style.display!="block"){this.content.style.top=b;this.content.style.left=a;this.content.style.display="block";if(this.options.mask){this.mask.style.display="block"}if(this.onOpen){this.onOpen()}}},hide:function(){if(this.content.style.display!="none"){this.content.style.display="none";if(this.options.mask){this.mask.style.display="none"}if(this.onClose){this.onClose()}}},getChilds:function(c,d){var a=[];var e=this.content.getElementsByTagName(c);for(var b=0;b<e.length;b++){if(!d){d=""}if(e[b].className==d){a.push(e[b])}}return a},remove:function(){if(this.content){this.content.parentNode.removeChild(this.content);document.body.removeChild(this.mask);this.content=null}},addEventListener:function(b,e,a){var c=this;var f=b;for(var d=0;d<f.length;d++){f[d][e]=function(g){g=g?g:window.event;if(a.call(c,this,g)){c.hide()}}}}};function ShowTipByClick(b,c,a){if(b){this.event=this.getCompatEvent(b);this.target=this.getTarget(this.event);this.target.blur()}this.tip=c;this.options={position:null,offsetX:0,offsetY:0,area:4,hide:false,autoPosition:true};this.setOptions(a);this.init()}ShowTipByClick.prototype={init:function(){if(this.options.hide==true){var b=this;this.tip.content.onclick=function(c){b.stopPropagation(c)};if(window.addEventListener){document.documentElement.addEventListener("click",function(c){b.close(c)},false);document.body.addEventListener("click",function(c){b.close(c)},false)}else{document.body.attachEvent("onclick",function(c){b.close(c)})}}else{if(this.options.hide=="mouseout"){var b=this;this.tip.content.onmouseout=function(c){b.timeout=window.setTimeout(function(){b.tip.hide()},200)};this.tip.content.onmouseover=function(c){if(b.timeout){window.clearTimeout(b.timeout);b.timeout=null}}}}var a={x:0,y:0};if(this.options.position!="center"){a=this.compute()}else{a=this.computeCenter()}if(this.options.yy){a.y=this.options.yy}this.tip.show(a.x,a.y)},setOptions:function(a){for(var b in (a||{})){this.options[b]=a[b]}return this},getCompatEvent:function(a){var a=a||window.event;this.event=a;return a},getTarget:function(a){if(a.target||a.srcElement){var b=a.target||a.srcElement}else{var b=a}while(b&&b.nodeType==3){b=b.parentNode}this.target=b;return b},getPage:function(a){var b={x:a.pageX||a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),y:a.pageY||a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)};this.page=b;return b},stopPropagation:function(a){a=a||window.event;if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},compute:function(){var b=(document.documentElement.clientHeight||document.body.clientHeight)+(document.documentElement.scrollTop||document.body.scrollTop);var e=document.body.offsetWidth;var d=this.getPage(this.event);if(this.options.position){d=this.getPoint(this.target,this.options.position[0])}this.position={x:d.x,y:d.y};this.position.x+=this.options.offsetX;this.position.y+=this.options.offsetY;var g=this.position.x;var f=this.position.y;var i=parseInt(this.tip.options.width);var c=parseInt(this.tip.options.height);var a=[[0,-c],[-i,-c],[-i,0],[0,0]];var j;if(this.options.position){j=a[this.options.position[1]-1]}else{if(g+i<=e&&f+c<=b){j=a[3]}if(g+i>e&&f+c<=b){j=a[2]}if(g+i<=e&&f+c>b){j=a[0]}if(g+i>e&&f+c>b){j=a[1]}}this.tip.content.className=this.tip.options.className+"_"+this.options.position[0]+"_"+this.options.position[1];return this.setPosition(j)},computeCenter:function(){var a={x:0,y:0};var d=this.getClientDimension("Height");var b=this.getClientDimension("Width");var c=document.documentElement.scrollTop;a.x=(b-parseInt(this.tip.options.width))/2+"px";a.y=c+(d-parseInt(this.tip.options.height))/2+"px";return a},getClientDimension:function(a){return document.documentElement["client"+a]||document.body["client"+a]},getDocumentDimension:function(a){return Math.max(document.documentElement["client"+a],document.body["scroll"+a],document.documentElement["scroll"+a],document.body["offset"+a],document.documentElement["offset"+a])},setPosition:function(b){var c=this.position.y+b[1]+"px";var a=this.position.x+b[0]+"px";return{x:a,y:c}},getPoint:function(c,a){var d={x:0,y:0};var b=c;while(b){d.x+=b.offsetLeft;d.y+=b.offsetTop;b=b.offsetParent}switch(a){case 1:d.x+=c.offsetWidth;break;case 2:break;case 3:d.y+=c.offsetHeight;break;case 4:d.y+=c.offsetHeight;d.x+=c.offsetWidth;break}return d},close:function(a){a=a||window.event;if(this.target!=this.getTarget(a)){this.tip.hide()}}};function Tabs(b,a){this.element=b;this.options={select:0,tag:"a",link:"",actived:"actived",hover:"",event:"onclick"};this.setOptions(a);this.init()}Tabs.prototype={setOptions:function(a){for(var b in (a||{})){this.options[b]=a[b]}return this},init:function(){this.cards=this.element.getElementsByTagName(this.options.tag);if(this.options.link!=""){var a=[];for(var c=0;c<this.cards.length;c++){if(this.cards[c].className==this.options.link){a.push(this.cards[c])}}this.cards=a}for(var c=0;c<this.cards.length;c++){this.cards[c].index=c}this.focus(this.cards[this.options.select]);var b=this;for(var c=0;c<this.cards.length;c++){this.cards[c].index=c;var b=this;this.cards[c][this.options.event]=function(){b.focus(this);return false}}},addClassName:function(b,a){if(b){b.className+=" "+a}},reduceClassName:function(d,b){if(d){var c=d.className.split(" ");for(var a=0;a<c.length;a++){if(c[a]==b){c[a]=""}}d.className=c.join(" ")}},focus:function(a){if(a==this.select){return false}this.reduceClassName(this.select,this.options.actived);this.select=a;this.addClassName(this.select,this.options.actived);if(this.options.content!=null){this.update(a.index,a)}if(this.options.update){this.options.update(a.index,a)}if(this.updateContent){this.updateContent(a.index,a)}return a},focusByIndex:function(a){if(this.cards[a]){this.focus(this.cards[a])}}};function checkMaxInput(e,a){var b=e.value;var f=0;var c=0;for(var d=0;d<b.length;d++){if((b.charCodeAt(d)>=0)&&(b.charCodeAt(d)<=255)){f=f+1;if(f<=a){c=c+1}}else{f=f+2;if(f<=a){c=c+1}}}if(f>a){e.value=b.substring(0,c)}}function checkLength(d,a){var b=d;var f=0;var c=0;for(var e=0;e<b.length;e++){if((b.charCodeAt(e)>=0)&&(b.charCodeAt(e)<=255)){f=f+1;if(f<=a){c=c+1}}else{f=f+2;if(f<=a){c=c+1}}}if(f>a){b=b.substring(0,c);b+="..."}return b}function checkLength_2(d,a){var b=d;var f=0;var c=0;for(var e=0;e<b.length;e++){if((b.charCodeAt(e)>=0)&&(b.charCodeAt(e)<=255)){f=f+1;if(f<=a){c=c+1}}else{f=f+2;if(f<=a){c=c+1}}}if(f>a){b=b.substring(0,c);b+="..."}return b}if(typeof portalServer=="undefined"){window.portalServer=""}function initPortalServer(a){window.portalServer=a}function encodeHtml(a){if(a==null||a.length==0){return""}a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/ /g,"&nbsp;");a=a.replace(/\'/g,"&#39;");a=a.replace(/\"/g,"&quot;");return a}var Message={};Message.APPLY_EXISTED="\u5df2\u7ecf\u5411TA\u53d1\u51fa\u9080\u8bf7\u4e86,\u7528\u4f60\u7684\u610f\u5ff5\u547c\u5524\u4e00\u4e0b\u5427!";Message.ALREADY_FIREND="TA\u5df2\u7ecf\u662f\u4f60\u7684\u597d\u53cb\u4e86";Message.USER_SETTING="\u4f60\u4e0d\u80fd\u6dfb\u52a0TA\u4e3a\u597d\u53cb,\u539f\u56e0\u53ef\u80fd\u662f:<br /> 1.\u4f60\u6216TA\u7684\u597d\u53cb\u7206\u6ee1\u4e86(\u6700\u591a1024\u4e2a)<br /> 2.\u4f60\u6216TA\u62d2\u7edd\u628a\u4efb\u4f55\u4eba\u52a0\u4e3a\u597d\u53cb.<br /> 3.\u4f60\u6216TA\u4e0d\u5e78\u5728\u5bf9\u65b9\u7684\u9ed1\u540d\u5355\u4e2d.";Message.DEFAULT_ERROR="\u64cd\u4f5c\u4e0d\u6210\u529f,\u53ef\u80fd\u662f\u7f51\u7edc\u95ee\u9898\u6216\u8005\u94fe\u63a5\u5931\u6548";Message.CAN_NOT_ADD_SELF="\u81ea\u5df1\u4e0d\u80fd\u52a0\u81ea\u5df1,\u9664\u975e\u4f60\u53d8\u6210\u4e24\u4e2a";Message.APPLY_SUCCESS="\u4ece\u73b0\u5728\u5f00\u59cb,\u4f60\u4eec\u4fe9\u5c31\u662f\u597d\u53cb\u4e86";function getApplySuccessMsg(a){return'\u4f60\u5df2\u7ecf\u5411<span style="font-weight: bold;padding: 0px 2px;">'+encodeHtml(a)+"</span>\u53d1\u51fa\u4e86\u597d\u53cb\u7533\u8bf7<br /> \u6b63\u5728\u7b49\u5f85\u5bf9\u65b9\u786e\u8ba4\uff01"}function onGetGroupInfoError(a){window.__group_status=2;window.__group_info=[{id:0,name:"\u672a\u5206\u7ec4\u8054\u7cfb\u4eba"}];triggerOpenApplyWindow(a);return true}function onGetGroupInfoSuccess(a,b){__group_status=a.groupStatus;if(__group_status===2){__group_info=a.groupInfo;triggerOpenApplyWindow(b)}else{return onGetGroupInfoError(b)}}function clearGlobalParameter(){window.__pi=null;window.__pn=null;window.__gi=0;window.__cb=null}function getGroupInfo(){var a=window.__group_info;if(a&&a.length){return a}return[{id:0,name:"\u672a\u5206\u7ec4\u8054\u7cfb\u4eba"}]}function changeGroup(a){window.__gi=a}function triggerOpenApplyWindow(f){var k=window.__pi;var d=window.__pn;f=f||1;if(!k){clearGlobalParameter();return false}var b=[];var e=0;b[e++]='<span class="addfriend_row_1">\u628a<em title="'+encodeHtml(d)+'">';b[e++]=encodeHtml(checkLength(d,6)+"...");b[e++]='</em>\u52a0\u4e3a\u6211\u7684\u597d\u53cb</span><span class="addfriend_row_2">TA\u540c\u610f\u6211\u7684\u9080\u8bf7\u540e\uff0c\u51fa\u73b0\u5728\uff1a</span><span class="addfriend_row_3">';b[e++]='<select name="select" onchange=changeGroup(this.value)>';var a=getGroupInfo();var h=null;for(var c=0;c<a.length;c++){b[e++]='<option value="'+(h=a[c]).id+'">'+encodeHtml(h.name)+"</option>"}b[e++]="</select>&nbsp;&nbsp;\u8fd9\u4e2a\u7ec4\u91cc</span>";call_alert("confrim",function(){processFriendApply(f)},b.join(""),"\u5c0f\u63d0\u793a","","\u786e\u5b9a\u6dfb\u52a0","\u53d6\u6d88","",clearGlobalParameter,280)}function triggerGetGroupInfo(b){var a="";if(typeof portalServer=="string"&&portalServer){a=portalServer}else{a="http://wang.alisoft.com/space"}a+="/friend/getGroupInfo.do?jsoncallback=?";__group_status=1;jQuery.ajax({type:"GET",url:a,timeout:30*1000,success:function(c){onGetGroupInfoSuccess(c,b)},error:function(){onGetGroupInfoError(b)},dataType:"json"})}function processFriendApply(c){var f=window.__pi;if(!f){return false}var b=window.__pn||f.substring(8);if(typeof portalServer=="undefined"||portalServer==""){portalServer="http://wang.alisoft.com/space"}var a=portalServer;if(c==1){a+="/invite/apply.do?jsoncallback=?"}else{a+="/invite/wangwang.do?jsoncallback=?"}var e={pi:f,gi:window.__gi||0};var d=window.__cb;clearGlobalParameter();jQuery.getJSON(a,e,function(g){if(g){var h=g.code;var j=g.message;if(h===0){var i=call_alert("alert","",getApplySuccessMsg(b),"\u5c0f\u63d0\u793a");setTimeout(function(){try{i.remove()}catch(k){}},2000)}else{if(c==2){j="DEFAULT_ERROR"}else{if(!j||!Message[j]){j="DEFAULT_ERROR"}}var i=call_alert("alert","",Message[j],"\u5c0f\u63d0\u793a")}if(d){d(h,j)}}})}function inviteUserToBecomeFriend(c,b,a,d){if(typeof __group_status=="undefined"){window.__group_status=0;window.__group_info=[]}if(!b||b.length<8){return}a=a||b.substring(8);if(__group_status===1){call_alert("alert","","\u597d\u53cb\u5206\u7ec4\u4fe1\u606f\u8f7d\u5165\u4e2d,\u8bf7\u7a0d\u5019\u518d\u8bd5","\u5c0f\u63d0\u793a")}else{c=c||1;a=a;window.__pi=b;window.__pn=a;window.__gi=0;window.__cb=d;if(__group_status===2){triggerOpenApplyWindow(c)}else{triggerGetGroupInfo(c)}}}function applyToBecomeSpaceFriend(b,a,c){inviteUserToBecomeFriend(1,b,a,c)}function inviteNonSpaceUserToUseSpace(b,a,c){inviteUserToBecomeFriend(2,b,a,c)}function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function random_class(e,d,g){var f=[];jQuery.each($("."+e),function(b,l){var h;do{var c=false;h=getRandomInt(1,g);var k=f.length;for(var a=0;a<k;a++){if(h==f[a]){c=true;break}}if(!c){f[k]=h;$(l).attr("class",d+h)}}while(c)})}function buzy(d,c){var b;if(!(window.tip&&window.tip.content)){var a="";a+='<div class="tip">';a+='<div class="tip_content">';a+='<h3 class="tip_header">'+d+"</h3>";a+='<div class="tip_ext">';a+='<div class="buzy">';a+='<img src="http://a.tbcdn.cn/app/sns/img/loading.gif"/>';a+='<span class="txt">'+c+"</span>";a+="</div>";a+="</div>";a+="</div>";a+="</div>";b=new TipDiv(a,{width:"250px",height:"200px",zIndex:999});b.addEventListener(b.getChilds("ins","tip_close"),"onclick",function(e){this.hide()});window.tip=b}else{b=window.tip}new ShowTipByClick(null,b,{position:"center"});return b};
